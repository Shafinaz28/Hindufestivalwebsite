<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>Pratham Sanskruti | Hindu Rituals & Traditions</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/feather-icons"></script>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#fffcf2; --panel:#fffef0; --haldi:#ffc300; --kumkum:#b30000;
      --chandan:#8b3d1f; --stroke:rgba(179,0,0,.15);
      --shadow:0 20px 50px rgba(139,61,31,.12);
    }
    *{box-sizing:border-box}
    html,body{font-family:'Poppins',sans-serif;background:var(--bg);color:#2b1a12;scroll-behavior:smooth}
    .brand-font{font-family:'Cinzel',serif}

    /* ===== HEADER (separate + logo) ===== */
    .topbar{
      position:fixed; top:0; left:0; right:0; z-index:50;
      background:linear-gradient(90deg,var(--kumkum),#800000);
      border-bottom:3px solid var(--haldi);
      box-shadow:0 4px 15px rgba(0,0,0,.2);
    }

    /* Cards / list items */
    .month-btn{
      background:#fff; border:1.5px solid var(--stroke);
      border-radius:10px; padding:10px 12px;
      font-weight:800; color:var(--chandan); cursor:pointer; transition:.25s;
      font-size:.75rem; text-transform:uppercase;
    }
    .month-btn:hover,.month-btn.active{background:var(--kumkum);color:#fff;border-color:var(--kumkum)}
    .fest-item{
      background:#fff; border-left:6px solid var(--haldi);
      padding:14px; border-radius:12px; transition:.25s; cursor:pointer;
      border:1px solid var(--stroke);
    }
    .fest-item:hover{background:#fff9e6;border-left-color:var(--kumkum);transform:translateX(4px)}
    .section-divider{height:2px;background:linear-gradient(to right,transparent,var(--haldi),transparent);margin:44px 0}

    /* Buttons */
    .haldi-btn{
      background:var(--haldi); color:#2b1a12; font-weight:900;
      padding:14px 26px; border-radius:999px; transition:.25s;
      text-transform:uppercase; letter-spacing:1px;
    }
    .haldi-btn:hover{background:#eab308; transform:scale(1.03)}
    .kumkum-btn{
      background:var(--kumkum); color:#fff; font-weight:900;
      padding:14px 26px; border-radius:999px; transition:.25s;
      text-transform:uppercase; letter-spacing:1px;
    }
    .kumkum-btn:hover{background:#8f0000; transform:scale(1.02)}

    /* Modal */
    .modal-backdrop{
      position:fixed; inset:0; background:rgba(0,0,0,.85);
      backdrop-filter:blur(8px);
      display:none; align-items:center; justify-content:center;
      z-index:1000;
    }
    .modal{
      background:#fff; width:95%; max-width:900px;
      border-radius:20px; border:4px solid var(--haldi);
      display:flex; overflow:hidden; max-height:85vh;
    }

    /* Shell spacing below fixed header */
    .page-pad{ padding-top: 74px; } /* header height */

    @media(max-width:768px){
      .modal{flex-direction:column; overflow-y:auto}
    }
  </style>
</head>

<body class="page-pad">

  <!-- ===== SEPARATE HEADER WITH LOGO ===== -->
  <header class="topbar">
    <div class="mx-auto max-w-6xl px-4 py-3 flex items-center justify-between gap-4">
      <a href="#home" class="flex items-center gap-3">
        <!-- Replace with your logo file -->
        <img src="./images/logo.png" alt="Pratham Sanskruti Logo"
             class="w-10 h-10 rounded-full object-cover ring-2 ring-[#f1c96e]"
             onerror="this.style.display='none'">
        <div>
          <div class="brand-font text-white text-xl md:text-2xl uppercase tracking-widest leading-tight">
            Pratham Sanskruti
          </div>
          <!-- <div class="text-[11px] text-[#ffe9c8] font-semibold tracking-wide">
            Hindu Rituals • Festivals • Traditions
          </div> -->
        </div>
      </a>

      <nav class="hidden md:flex items-center gap-6 text-sm font-bold text-[#ffe9c8]">
        <a href="#about" class="hover:text-white">About</a>
        <a href="#store" class="hover:text-white">In Store</a>
        <a href="#calendar" class="hover:text-white">Calendar</a>
        <button onclick="openJoinForm()" class="px-4 py-2 rounded-full bg-white/10 hover:bg-white/20 border border-white/20">
          Join
        </button>
      </nav>
    </div>
  </header>

  <!-- ===== HERO (image RIGHT, info LEFT) ===== -->
  <section id="home" class="relative overflow-hidden bg-[#fbf4e7]">
    <div class="absolute inset-0 opacity-60"
      style="background-image:url('./images/hero/arch-bg.png'); background-size:cover; background-position:center;"></div>
    <div class="absolute inset-0 bg-gradient-to-b from-[#fff7ea]/80 via-[#fff7ea]/60 to-[#fbf4e7]"></div>

    <div class="relative mx-auto max-w-6xl px-4 py-14 md:py-20">
      <div class="grid lg:grid-cols-2 gap-10 items-center">
        <!-- LEFT INFO -->
        <div>
          <div class="flex items-center gap-3 mb-4">
            <img src="./images/hero/icon-ganesha.png" class="w-12 drop-shadow" alt="">
            <div class="text-xs font-black tracking-[0.25em] uppercase text-[var(--kumkum)]">
              Pratham Sanskruti
            </div>
          </div>

          <h1 class="brand-font text-4xl md:text-5xl leading-tight text-[#4a0b0b]">
            Celebrate the Spirit of
            <span class="block text-[#b30000]">Hindu Festivals</span>
          </h1>

          <p class="mt-3 text-base md:text-lg text-stone-700 font-medium">
            हिन्दू त्योहारों का उत्सव मनाएं — rituals, reminders, and traditions in one place.
          </p>

          <div class="mt-6 flex flex-col sm:flex-row items-center justify-center gap-4">
  <a href="#about" class="haldi-btn shadow-lg">Explore</a>
  <a href="#calendar" class="kumkum-btn shadow-lg">Festival Calendar</a>
</div>


          <div class="mt-8 bg-white/70 border border-[var(--stroke)] rounded-2xl p-5 shadow-sm">
            <div class="text-sm text-stone-700 font-semibold">
              ✅ Timely festival reminders • ✅ Simple ritual guidance • ✅ Cultural learning for kids
            </div>
          </div>
        </div>

        <!-- RIGHT IMAGE -->
        <div class="relative">
          <!-- Replace with your best hero image -->
          <div class="rounded-[28px] overflow-hidden border-[3px] border-[#f1c96e] shadow-xl bg-white">
            <img src="./images/bgimages.png" alt="Hero"
                 class="w-full h-[320px] md:h-[420px] object-cover"
                 onerror="this.src='images/placeholder.jpg'">
          </div>

          <!-- small floating accents -->
              </div>
      </div>
    </div>
  </section>

  <main class="mx-auto max-w-6xl px-4 pb-16">
    <!-- ===== ABOUT (separate section) ===== -->
    <section id="about" class="mt-10">
      <div class="bg-[var(--panel)] rounded-3xl border border-[var(--stroke)] shadow-[var(--shadow)] p-7 md:p-10">
        <div class="text-center mb-8">
          <h2 class="brand-font text-3xl text-[var(--kumkum)] uppercase">About Us</h2>
          <div class="h-1 w-20 bg-[var(--haldi)] mx-auto mt-2"></div>
        </div>

        <div class="grid md:grid-cols-2 gap-8 items-center">
          <div class="space-y-4">
            <p class="leading-relaxed text-stone-600 font-medium">
              At <strong>Pratham Sanskruti</strong>, we honor the profound essence of Hindu rituals.
              We combine ancient wisdom with modern clarity—so every event is performed with cultural integrity.
            </p>
            <p class="leading-relaxed text-stone-600">
              We preserve and share the timeless wisdom of Sanatan Dharma, making traditions accessible through simple, step-by-step guidance.
            </p>
          </div>

          <div class="bg-white p-6 rounded-2xl border-r-8 border-[var(--kumkum)] shadow-sm italic text-[var(--chandan)]">
            “Stay aligned with every important tithi and festival. Timely reminders so you never miss an auspicious day for vrats or pujas.”
          </div>
        </div>

        <!-- ===== BUTTON (separate) ===== -->
        <div class="text-center mt-10">
          <button onclick="startJourney()" class="haldi-btn shadow-lg">
            START THE JOURNEY TO YOUR ROOTS
          </button>
        </div>
      </div>
    </section>

    <!-- ===== IN STORE (separate section) ===== -->
    <section id="store" class="mt-12 hidden">
      <div class="section-divider"></div>

      <div class="bg-[var(--panel)] rounded-3xl border border-[var(--stroke)] shadow-[var(--shadow)] p-7 md:p-10">
        <div class="text-center mb-8">
          <h2 class="brand-font text-3xl text-[var(--kumkum)] uppercase">In Store</h2>
          <div class="h-1 w-20 bg-[var(--haldi)] mx-auto mt-2"></div>
          <p class="text-stone-600 mt-3 max-w-2xl mx-auto">
            Choose a category to explore. Click any card to view details.
          </p>
        </div>

        <div id="storeCardsGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5"></div>

        <div id="storeDetailView" class="hidden mt-10">
          <div class="flex items-center justify-between gap-4 mb-6">
            <button onclick="backToStoreCards()"
              class="px-4 py-2 rounded-full border border-[var(--stroke)] bg-white hover:bg-[#fff9e6] font-bold text-[var(--chandan)] flex items-center gap-2">
              <i data-feather="arrow-left" class="w-4 h-4"></i>
              Back to all
            </button>

            <span class="text-xs font-black uppercase tracking-widest text-stone-400">
              Pratham Sanskruti • In Store
            </span>
          </div>

          <div class="bg-white rounded-2xl border border-[var(--stroke)] shadow-sm overflow-hidden">
            <div class="h-56 w-full bg-stone-100">
              <img id="detailImg" src="" alt="" class="w-full h-full object-cover"
                   onerror="this.src='images/placeholder.jpg'">
            </div>

            <div class="p-8">
              <div class="flex items-start gap-4">
                <div class="w-12 h-12 rounded-2xl flex items-center justify-center bg-[#fff3c4] border border-[var(--stroke)]">
                  <i id="detailIcon" data-feather="star" class="w-6 h-6 text-[var(--kumkum)]"></i>
                </div>

                <div class="flex-1">
                  <h3 id="detailTitle" class="brand-font text-2xl text-[var(--kumkum)] mb-2"></h3>
                  <p id="detailIntro" class="text-stone-600 font-medium leading-relaxed"></p>
                </div>
              </div>

              <div class="mt-8 grid md:grid-cols-2 gap-8">
                <div>
                  <h5 class="text-[10px] font-black text-stone-400 uppercase mb-2">What we do</h5>
                  <p id="detailBody" class="text-sm text-stone-600 leading-relaxed"></p>
                </div>
                <div>
                  <h5 class="text-[10px] font-black text-stone-400 uppercase mb-2">Why it matters</h5>
                  <p id="detailWhy" class="text-sm text-stone-600 leading-relaxed"></p>
                </div>
              </div>

              <div class="text-center mt-10">
                <button onclick="goToFestivalCalendar()" class="kumkum-btn shadow-lg">
                  Continue to Festival Calendar
                </button>
              </div>
            </div>
          </div>
        </div>

      </div>
    </section>

    <!-- ===== CALENDAR (separate section) ===== -->
    <section id="calendar" class="mt-12">
      <div class="section-divider"></div>

      <div class="bg-[var(--panel)] rounded-3xl border border-[var(--stroke)] shadow-[var(--shadow)] p-7 md:p-10">
        <div class="text-center mb-8">
          <h2 class="brand-font text-3xl text-[var(--kumkum)] uppercase">Festival Calendar</h2>
          <div class="h-1 w-20 bg-[var(--haldi)] mx-auto mt-2"></div>
        </div>

        <!-- ===== MONTH NAMES (separate row) ===== -->
        <div class="sticky top-[72px] bg-[var(--panel)] py-4 z-40 border-b-2 border-[var(--haldi)] mb-6">
          <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
            <h4 class="brand-font text-center md:text-left text-lg text-[var(--chandan)] uppercase tracking-widest">
              2026 Monthly Directory
            </h4>

            <!-- ===== VIEW TOGGLE (GRID / TABLE) ===== -->
            <div class="flex items-center justify-center md:justify-end gap-2">
              <button id="viewGridBtn" onclick="setView('grid')"
                      class="px-4 py-2 rounded-full border border-[var(--stroke)] bg-white hover:bg-[#fff9e6] font-black text-[var(--chandan)]">
                Grid View
              </button>
              <button id="viewTableBtn" onclick="setView('table')"
                      class="px-4 py-2 rounded-full border border-[var(--stroke)] bg-white hover:bg-[#fff9e6] font-black text-[var(--chandan)]">
                Table View
              </button>
            </div>
          </div>

          <div id="monthsGrid" class="flex flex-wrap justify-center md:justify-start gap-2 mt-4"></div>
        </div>

        <!-- directory will render inside -->
        <div id="festivalDirectory" class="space-y-14"></div>

        <div class="text-center mt-12">
          <button onclick="openJoinForm()" class="kumkum-btn shadow-lg">Join Pratham Sanskruti</button>
        </div>
      </div>
    </section>
  </main>

  <!-- ===== FESTIVAL MODAL ===== -->
  <div id="festivalModal" class="modal-backdrop" onclick="closeModal()">
    <div class="modal" onclick="event.stopPropagation()">
      <div class="md:w-1/2 w-full h-64 md:h-auto bg-stone-100 flex-shrink-0">
        <img id="modalImg" class="w-full h-full object-cover" src="" alt=""
             onerror="this.src='images/placeholder.jpg'">
      </div>
      <div class="md:w-1/2 w-full p-8 overflow-y-auto flex-1 min-w-0">
        <button onclick="closeModal()" class="float-right text-stone-400 hover:text-red-600">
          <i data-feather="x"></i>
        </button>
        <h2 id="modalTitle" class="brand-font text-2xl text-[var(--kumkum)] mb-1"></h2>
        <p id="modalHindi" class="text-base text-stone-600 mb-3"></p>
        <div id="modalMeta" class="text-xs font-bold text-stone-500 uppercase tracking-widest border-b pb-4 mb-6"></div>

        <div class="mb-6">
          <h5 class="text-[10px] font-black text-stone-400 uppercase mb-2">Significance</h5>
          <p id="modalSign" class="text-sm text-stone-600 leading-relaxed"></p>
        </div>
        <div class="mb-6" id="modalKathaBlock">
          <h5 class="text-[10px] font-black text-stone-400 uppercase mb-2">Katha</h5>
          <p id="modalKatha" class="text-sm text-stone-600 leading-relaxed"></p>
        </div>
        <div class="mb-6" id="modalProcBlock">
          <h5 class="text-[10px] font-black text-stone-400 uppercase mb-2">Procedure</h5>
          <div id="modalProc" class="text-sm text-stone-600 leading-relaxed space-y-2"></div>
        </div>
        <div class="mb-6" id="modalFastBlock">
          <h5 class="text-[10px] font-black text-stone-400 uppercase mb-2">Fasting</h5>
          <p id="modalFast" class="text-sm text-stone-600 leading-relaxed"></p>
        </div>
        <div class="mb-6" id="modalDaanBlock">
          <h5 class="text-[10px] font-black text-stone-400 uppercase mb-2">Daan</h5>
          <p id="modalDaan" class="text-sm text-stone-600 leading-relaxed"></p>
        </div>
        <div id="modalNotesBlock" class="hidden">
          <h5 class="text-[10px] font-black text-stone-400 uppercase mb-2">Notes</h5>
          <p id="modalNotes" class="text-sm text-stone-600 leading-relaxed"></p>
        </div>
      </div>
    </div>
  </div>

  <!-- ===== JOIN MODAL ===== -->
  <div id="joinModal" class="modal-backdrop" onclick="closeJoinForm()">
    <div class="modal !max-w-md p-10 relative flex-col" onclick="event.stopPropagation()">
      <button onclick="closeJoinForm()" class="absolute top-4 right-4 text-stone-400">
        <i data-feather="x"></i>
      </button>
      <h3 class="brand-font text-3xl text-[var(--kumkum)] mb-6 text-center">Membership</h3>
      <form class="space-y-4">
        <input type="text" placeholder="Full Name"
          class="w-full border-b-2 border-stone-200 py-3 focus:border-[var(--haldi)] transition-all outline-none bg-transparent">
        <input type="email" placeholder="Email"
          class="w-full border-b-2 border-stone-200 py-3 focus:border-[var(--haldi)] transition-all outline-none bg-transparent">
        <button type="submit" class="w-full kumkum-btn mt-4 shadow-lg">REGISTER INTEREST</button>
      </form>
    </div>
  </div>

  <script>
    feather.replace();

    // -----------------------------
    // IN STORE DATA (same as yours)
    // -----------------------------
    const storeServices = [
      {
        key: "rituals",
        icon: "sun",
        title: "Ritual Procedures / Sacred Events",
        images: "Ritual-Procedures-Sacred-Events.jpg",
        intro:
          "Pratham Sanskruti unites timeless Hindu tradition with modern precision by creating clear, practical blueprints for sacred events like Shanti Pujas and Griha Pravesha.",
        body:
          "Every act in a sacred ritual — lighting a diya, offering flowers, observing a fast, participating in a yatra — carries intention and transforms the mind toward gratitude and self-awareness. We design each ceremony so spiritual depth is matched by smooth logistics, giving families confidence that both dharmic and practical details are fully cared for.\n\nIn this way, Pratham Sanskruti shows how India’s timeless wisdom can guide modern life toward greater harmony, seva, and inner growth.",
        why:
          "Sacred Rituals & Timing align worship with auspicious moments using tithi, nakshatra, and muhurat from the Panchang so your effort flows with cosmic rhythm."
      },
      {
        key: "calendar",
        icon: "calendar",
        title: "Hindu Calendar",
        images: "Hindu-Calendar.jpg",
        intro:
          "At Pratham Sanskruti, we help you stay effortlessly aligned with this timeless rhythm — with timely reminders and support.",
        body:
          "Our service provides timely reminders for key Hindu calendar events and supports you with arrangements as per your needs—so you never miss an auspicious day.",
        why:
          "Hindu calendar events are sacred dates marked by tithis, nakshatras, and seasons, guiding when to perform important rituals."
      },
      {
        key: "aarti",
        icon: "music",
        title: "Aarti and Mantra",
        images: "Aarti-and-Mantra.jpg",
        intro:
          "Guided audio and video resources so your family can chant confidently, perform pooja and aarti step by step, and observe each ritual at the right time.",
        body:
          "We provide guided audio/video resources so your family can chant confidently and follow authentic steps. Great for families and kids to learn correctly.",
        why:
          "Correct chanting and properly performed pooja or aarti create focus, devotion, and respect for tradition."
      },
      {
        key: "seva",
        icon: "heart",
        title: "Sevā–Dān",
        images: "Seva-Daan.jpg",
        intro:
          "At Pratham Sanskruti, dāna (donation) is at the heart of what we do — a sacred duty that strengthens society.",
        body:
          "In the Hindu tradition, dāna is not just charity; it is a sacred duty that purifies the heart and supports those in need.",
        why:
          "We organise four structured donation-focused events every year for easy, trusted giving."
      },
      {
        key: "workshops",
        icon: "users",
        title: "Cultural Workshops",
        images: "Cultural-Workshops.jpg",
        intro:
          "Small, engaging Cultural Workshops for children to build early awareness of traditions, stories, and values.",
        body:
          "Age-appropriate activities like stories, simple bhajans, arts and crafts, and festival themed games—culture becomes joyful and living.",
        why:
          "Helps kids build identity, respect, and pride in heritage."
      },
      {
        key: "hampers",
        icon: "gift",
        title: "Pooja Items / Hamper & Gifting",
        images: "Pooja-Hampers.jpg",
        intro:
          "Pooja hampers and gifting options for festivals, weddings, and religious days—curated and delivered with care.",
        body:
          "Curated hampers that blend tradition with a premium feel—packed for the occasion, delivered on time.",
        why:
          "Can include diyas, incense, kumkum holders, sweets, eco-friendly puja essentials, and more."
      }
    ];

    function buildStoreCards() {
      const grid = document.getElementById("storeCardsGrid");
      if (!grid) return;

      grid.innerHTML = storeServices.map(s => `
        <div class="bg-white rounded-2xl border border-[var(--stroke)] shadow-sm overflow-hidden cursor-pointer hover:bg-[#fff9e6] transition"
             onclick="openStoreDetail('${s.key}')">
          <div class="h-40 w-full bg-stone-100">
            <img src="images/${s.images}" alt="${s.title}" class="w-full h-full object-cover"
                 onerror="this.src='images/placeholder.jpg'">
          </div>
          <div class="p-6">
            <div class="flex items-start gap-4">
              <div class="w-12 h-12 rounded-2xl flex items-center justify-center bg-[#fff3c4] border border-[var(--stroke)]">
                <i data-feather="${s.icon}" class="w-6 h-6 text-[var(--kumkum)]"></i>
              </div>
              <div class="flex-1">
                <h4 class="font-black text-[var(--chandan)] leading-tight">${s.title}</h4>
                <p class="text-sm text-stone-600 mt-2 leading-relaxed">${s.intro}</p>
                <div class="mt-4 text-[10px] font-black uppercase tracking-widest text-[var(--kumkum)]">
                  Tap to view details →
                </div>
              </div>
            </div>
          </div>
        </div>
      `).join("");

      feather.replace();
    }

    function startJourney() {
      const store = document.getElementById("store");
      store.classList.remove("hidden");
      document.getElementById("storeDetailView").classList.add("hidden");
      document.getElementById("storeCardsGrid").classList.remove("hidden");
      buildStoreCards();
      store.scrollIntoView({ behavior: "smooth", block: "start" });
    }

    function openStoreDetail(key) {
      const s = storeServices.find(x => x.key === key);
      if (!s) return;

      document.getElementById("storeCardsGrid").classList.add("hidden");
      document.getElementById("storeDetailView").classList.remove("hidden");

      document.getElementById("detailTitle").innerText = s.title;
      document.getElementById("detailIntro").innerText = s.intro;
      document.getElementById("detailBody").innerText = s.body;
      document.getElementById("detailWhy").innerText = s.why;

      const detailImg = document.getElementById("detailImg");
      detailImg.src = `images/${s.images}`;
      detailImg.alt = s.title;
      detailImg.onerror = function () { this.src = "images/placeholder.jpg"; };

      const iconEl = document.getElementById("detailIcon");
      iconEl.setAttribute("data-feather", s.icon);
      feather.replace();

      document.getElementById("storeDetailView").scrollIntoView({ behavior: "smooth", block: "start" });
    }

    function backToStoreCards() {
      document.getElementById("storeDetailView").classList.add("hidden");
      document.getElementById("storeCardsGrid").classList.remove("hidden");
      feather.replace();
    }

    function goToFestivalCalendar() {
      document.getElementById("calendar").scrollIntoView({ behavior: "smooth", block: "start" });
    }

    // -----------------------------
    // FESTIVAL CALENDAR + VIEW TOGGLE
    // -----------------------------
    let festivalData = [];
    let currentView = "grid"; // 'grid' or 'table'

    function setView(view) {
      currentView = view;
      const gridBtn = document.getElementById("viewGridBtn");
      const tableBtn = document.getElementById("viewTableBtn");

      // visual active state
      if (view === "grid") {
        gridBtn.style.background = "var(--kumkum)";
        gridBtn.style.color = "#fff";
        gridBtn.style.borderColor = "var(--kumkum)";
        tableBtn.style.background = "#fff";
        tableBtn.style.color = "var(--chandan)";
        tableBtn.style.borderColor = "var(--stroke)";
      } else {
        tableBtn.style.background = "var(--kumkum)";
        tableBtn.style.color = "#fff";
        tableBtn.style.borderColor = "var(--kumkum)";
        gridBtn.style.background = "#fff";
        gridBtn.style.color = "var(--chandan)";
        gridBtn.style.borderColor = "var(--stroke)";
      }

      buildCalendar(); // re-render
    }

    async function loadFestivals() {
      try {
        const response = await fetch("festivals.json");
        const data = await response.json();
        festivalData = data.months || [];
        setView("grid"); // default render + active state
      } catch (e) {
        console.error("JSON file 'festivals.json' not found or has errors.", e);
      }
    }

    function buildCalendar() {
      const nav = document.getElementById("monthsGrid");
      const directory = document.getElementById("festivalDirectory");
      nav.innerHTML = "";
      directory.innerHTML = "";

      festivalData.forEach((m, idx) => {
        // month buttons
        const btn = document.createElement("button");
        btn.className = "month-btn";
        btn.innerText = (m.month || "").substring(0, 3);
        btn.onclick = () => document.getElementById(`month-block-${idx}`)
          .scrollIntoView({ behavior: "smooth", block: "start" });
        nav.appendChild(btn);

        // month section
        const section = document.createElement("div");
        section.id = `month-block-${idx}`;
        section.className = "scroll-mt-32";

        // render view
        const items = (m.items || []);

        const gridHTML = `
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            ${items.map(f => `
              <div class="fest-item" onclick='openModal(${JSON.stringify(f)}, "${m.month}")'>
                <div class="flex justify-between items-center gap-3">
                  <div class="min-w-0">
                    <h5 class="font-bold text-lg truncate">${f.englishname || ""}</h5>
                    <p class="text-[10px] text-[var(--kumkum)] font-bold uppercase tracking-tighter">
                      ${[f.date, f.day, f.tithimonth].filter(Boolean).join(" • ")}
                    </p>
                  </div>
                  <i data-feather="chevron-right" class="w-4 h-4 text-stone-300 flex-shrink-0"></i>
                </div>
              </div>
            `).join("")}
          </div>
        `;

        const tableHTML = `
          <div class="overflow-x-auto bg-white rounded-2xl border border-[var(--stroke)] shadow-sm">
            <table class="min-w-full text-sm">
              <thead class="bg-[#fff3c4]">
                <tr class="text-left">
                  <th class="px-4 py-3 font-black text-[var(--chandan)]">Date</th>
                  <th class="px-4 py-3 font-black text-[var(--chandan)]">Festival</th>
                  <th class="px-4 py-3 font-black text-[var(--chandan)]">Day</th>
                  <th class="px-4 py-3 font-black text-[var(--chandan)]">Type</th>
                </tr>
              </thead>
              <tbody>
                ${items.map(f => `
                  <tr class="border-t hover:bg-[#fff9e6] cursor-pointer"
                      onclick='openModal(${JSON.stringify(f)}, "${m.month}")'>
                    <td class="px-4 py-3 whitespace-nowrap font-bold text-stone-700">${f.date || "—"}</td>
                    <td class="px-4 py-3">
                      <div class="font-extrabold text-stone-800">${f.englishname || "—"}</div>
                      <div class="text-xs text-stone-500">${f.hindiname || ""}</div>
                    </td>
                    <td class="px-4 py-3 whitespace-nowrap text-stone-600 font-semibold">${f.day || "—"}</td>
                    <td class="px-4 py-3 whitespace-nowrap text-stone-600 font-semibold">${f.type || "—"}</td>
                  </tr>
                `).join("")}
              </tbody>
            </table>
          </div>
          <div class="text-xs text-stone-500 mt-3 font-semibold">
            Tip: Click any row to open full details.
          </div>
        `;

        section.innerHTML = `
          <div class="flex items-center gap-4 mb-6">
            <h3 class="brand-font text-3xl text-[var(--chandan)]">${m.month || ""}</h3>
            <div class="h-px bg-[var(--haldi)] flex-grow"></div>
          </div>
          ${currentView === "grid" ? gridHTML : tableHTML}
        `;

        directory.appendChild(section);
      });

      feather.replace();
    }

    // -----------------------------
    // FESTIVAL MODAL (same logic)
    // -----------------------------
    function openModal(f, mName) {
      document.getElementById("modalTitle").innerText = f.englishname || "";
      document.getElementById("modalHindi").innerText = f.hindiname || "";
      document.getElementById("modalMeta").innerText =
        [mName, f.date, f.day, f.type, f.tithimonth, f.muhurat, f.focus].filter(Boolean).join(" • ");

      const modalImg = document.getElementById("modalImg");
      modalImg.src = f.images ? "images/" + f.images : "images/placeholder.jpg";
      modalImg.alt = f.englishname || "";
      modalImg.onerror = function () { this.src = "images/placeholder.jpg"; };

      document.getElementById("modalSign").innerText = f.significance || "—";

      const kathaBlock = document.getElementById("modalKathaBlock");
      const kathaEl = document.getElementById("modalKatha");
      if (f.katha) { kathaBlock.classList.remove("hidden"); kathaEl.innerText = f.katha; }
      else { kathaBlock.classList.add("hidden"); }

      const procEl = document.getElementById("modalProc");
      const procBlock = document.getElementById("modalProcBlock");
      const procItems = [
        f.morning && { label: "Morning", text: f.morning },
        f.daytime && { label: "Daytime", text: f.daytime },
        f.mainpuja && { label: "Main Puja", text: f.mainpuja }
      ].filter(Boolean);

      if (procItems.length) {
        procBlock.classList.remove("hidden");
        procEl.innerHTML = procItems
          .map(({ label, text }) => `<p><strong class="text-stone-700">${label}:</strong> ${text}</p>`)
          .join("");
      } else {
        procBlock.classList.add("hidden");
      }

      const fastBlock = document.getElementById("modalFastBlock");
      const fastEl = document.getElementById("modalFast");
      if (f.fastingrules) { fastBlock.classList.remove("hidden"); fastEl.innerText = f.fastingrules; }
      else { fastBlock.classList.add("hidden"); }

      const daanBlock = document.getElementById("modalDaanBlock");
      const daanEl = document.getElementById("modalDaan");
      if (f.daan) { daanBlock.classList.remove("hidden"); daanEl.innerText = f.daan; }
      else { daanBlock.classList.add("hidden"); }

      const notesBlock = document.getElementById("modalNotesBlock");
      const notesEl = document.getElementById("modalNotes");
      if (f.notes) { notesBlock.classList.remove("hidden"); notesEl.innerText = f.notes; }
      else { notesBlock.classList.add("hidden"); }

      document.getElementById("festivalModal").style.display = "flex";
      document.body.style.overflow = "hidden";
      feather.replace();
    }

    function closeModal() {
      document.getElementById("festivalModal").style.display = "none";
      document.body.style.overflow = "auto";
    }

    function openJoinForm() {
      document.getElementById("joinModal").style.display = "flex";
      document.body.style.overflow = "hidden";
      feather.replace();
    }

    function closeJoinForm() {
      document.getElementById("joinModal").style.display = "none";
      document.body.style.overflow = "auto";
    }

    // Init
    loadFestivals();
  </script>
</body>
</html>
